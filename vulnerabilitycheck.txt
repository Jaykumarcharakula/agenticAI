aws inspector2 batch-get-account-status \
  --account-ids $(aws sts get-caller-identity --query Account --output text) \
  --region eu-west-1 \
  --query 'accounts[].resourceState' \
  --output table
**************

# Critical count
aws inspector2 list-findings \
  --filter-criteria '{"severity":[{"comparison":"EQUALS","value":"CRITICAL"}],"findingStatus":[{"comparison":"EQUALS","value":"ACTIVE"}]}' \
  --region eu-west-1 \
  --query 'length(findings)' \
  --output text

# High count
aws inspector2 list-findings \
  --filter-criteria '{"severity":[{"comparison":"EQUALS","value":"HIGH"}],"findingStatus":[{"comparison":"EQUALS","value":"ACTIVE"}]}' \
  --region eu-west-1 \
  --query 'length(findings)' \
  --output text

# Medium count
aws inspector2 list-findings \
  --filter-criteria '{"severity":[{"comparison":"EQUALS","value":"MEDIUM"}],"findingStatus":[{"comparison":"EQUALS","value":"ACTIVE"}]}' \
  --region eu-west-1 \
  --query 'length(findings)' \
  --output text

***********
aws inspector2 list-findings \
  --filter-criteria '{
    "severity":[
      {"comparison":"EQUALS","value":"CRITICAL"},
      {"comparison":"EQUALS","value":"HIGH"},
      {"comparison":"EQUALS","value":"MEDIUM"}
    ],
    "findingStatus":[{"comparison":"EQUALS","value":"ACTIVE"}]
  }' \
  --region eu-west-1 \
  --query 'findings[].{CVE:packageVulnerabilityDetails.vulnerabilityId, Severity:severity, Resource:resources[0].id, Title:title}' \
  --output table

************


aws inspector2 list-findings \
  --filter-criteria '{
    "severity":[
      {"comparison":"EQUALS","value":"CRITICAL"},
      {"comparison":"EQUALS","value":"HIGH"}
    ],
    "findingStatus":[{"comparison":"EQUALS","value":"ACTIVE"}]
  }' \
  --region eu-west-1 \
  --query 'findings[].resources[0].type' \
  --output text